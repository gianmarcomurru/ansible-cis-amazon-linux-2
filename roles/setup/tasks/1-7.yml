---
# 1.7.1 Ensure message of the day is configured properly

# /etc/motd is dynamically generated by pam on login. The intention of this check is to ensure that OS
# information is not disclosed, therefore the more appropriate option is to ensure that the scripts which
# generate motd, and which are related to system information which would otherwise be
# displayed by mingetty options, are not present.
- name: 1.7.1 - Ensure message of the day is configured properly
  ansible.builtin.file:
    path: "{{ item }}"
    state: absent
  with_items:
    - /etc/motd
    - /etc/update-motd.d/30-banner
    - /etc/update-motd.d/50-amazon-linux-extras-news
    - /etc/update-motd.d/70-available-updates
  tags:
    - level-1
    - 1.7.1
    - automated

- name: 1.7.1 - Ensure message of the day is configured properly
  ansible.builtin.copy:
    dest: /etc/update-motd.d/99-banner
    owner: root
    group: root
    mode: "0644"
    content: "Authorized users only. All activity are monitored and reported.\n"
  tags:
    - level-1
    - 1.7.1
    - automated

# 1.7.2 Ensure local login warning banner is configured properly

- name: 1.7.2 - Ensure local login warning banner is configured properly
  ansible.builtin.copy:
    content: "Authorized users only. All activity are monitored and reported.\n"
    dest: /etc/issue
    owner: root
    group: root
    mode: "0644"
  tags:
    - level-1
    - 1.7.2
    - manual

# 1.7.3 Ensure remote login warning banner is configured properly

- name: 1.7.3 - Ensure remote login warning banner is configured properly
  ansible.builtin.copy:
    content: "Authorized users only. All activity are monitored and reported.\n"
    dest: /etc/issue.net
    owner: root
    group: root
    mode: "0644"
  tags:
    - level-1
    - 1.7.3
    - manual

# 1.7.4 Ensure permissions on /etc/motd are configured

- name: 1.7.4 - Ensure permissions on /etc/motd are configured
  ansible.builtin.copy:
    src: motd
    dest: /etc/motd
    owner: root
    group: root
    mode: "0644"
  tags:
    - level-1
    - 1.7.4
    - manual

# 1.7.5 Ensure permissions on /etc/issue are configured

- name: 1.7.5 - Ensure permissions on /etc/issue are configured
  ansible.builtin.file:
    path: /etc/issue
    owner: root
    group: root
    mode: "0644"
  tags:
    - level-1
    - 1.7.5
    - automated

# 1.7.6 Ensure permissions on /etc/issue.net are configured

- name: 1.7.6 - Ensure permissions on /etc/issue.net are configured
  ansible.builtin.file:
    path: /etc/issue.net
    owner: root
    group: root
    mode: "0644"
  tags:
    - level-1
    - 1.7.6
    - manual
